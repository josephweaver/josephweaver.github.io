<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="x-ua-compatible" content="ie=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>{% if page.title %}{{ page.title }} - {% endif %}{{ site.title }}</title>

  {%- seo -%}

  <link rel="stylesheet" href="{{ "/assets/css/styles.css" | relative_url }}" />
  <link rel="stylesheet" href="{{ "/assets/css/custom.css" | relative_url }}" />

  <!-- MathJax v3 config -->
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$','$$'], ['\\[','\\]']],
        processEscapes: true,
        tags: 'ams',                         // equation numbering like \tag, \label, \ref
        packages: {'[+]': ['noerrors']}      // avoid throwing visible errors on the page
      },
      options: {
        skipHtmlTags: ['script','noscript','style','textarea','pre','code'] // don't typeset inside code blocks
      }
    };
  </script>
  <script id="MathJax-script" async
          src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

  <style>
    /* Optional: keep MathJax font size aligned with body text */
    mjx-container[jax="CHTML"] { font-size: 100%; }
  </style>
</head>

<body>
  {% assign is_lecture = page.path contains "STT882/lec" %}
  {% assign lecture_pages = site.pages | where_exp: "p", "p.path contains 'STT882/lec'" | sort_natural: "path" %}
  {% assign lecture_static = site.static_files | where_exp: "f", "f.path contains '/STT882/lec'" | sort_natural: "path" %}
  {% if lecture_pages == empty and lecture_static != empty %}
    {% assign lectures = lecture_static %}
  {% else %}
    {% assign lectures = lecture_pages %}
  {% endif %}
  {% assign lectures = lectures | sort_natural: "path" %}

  <div class="layout">
    <aside class="sidebar" id="lectureSidebar">
      <div class="sidebar__header">
        <span>Navigation</span>
        <a class="sidebar__reset" href="#" id="sidebarReset" title="Reset width">Reset</a>
      </div>
      <ul class="lecture-nav__list">
        <li>
          <a class="{% if page.url == "/" or page.url == "/index.html" %}active{% endif %}"
             href="{{ "/" | relative_url }}">Home</a>
        </li>
        <li>
          <a class="{% if is_lecture %}active{% endif %}"
             href="{{ "/STT882/lec1.html" | relative_url }}">Probability 2</a>
        </li>
        {% if is_lecture %}
          <li class="lecture-nav__heading">Probability 2 Lectures</li>
          {% for lecture in lectures %}
            {% assign label = lecture.title | default: lecture.data.title | default: lecture.name %}
            {% assign label = label | replace: ".html", "" | replace: ".md", "" | replace: "_", " " %}
            <li>
              <a class="{% if lecture.url == page.url %}active{% endif %}"
                 href="{{ lecture.url | default: lecture.path | relative_url }}">
                {{ label }}
              </a>
            </li>
          {% endfor %}
        {% endif %}
      </ul>
    </aside>
    <div class="sidebar-resizer" id="sidebarResizer" role="separator" aria-orientation="vertical" aria-label="Resize navigation"></div>

    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        {{ content }}
      </div>
    </main>
  </div>

  <footer class="site-footer">
    <small>&copy; {{ site.time | date: "%Y" }} {{ site.author | default: site.title }}</small>
  </footer>

  <style>
    :root {
      --sidebar-width: 240px;
      --sidebar-min: 180px;
      --sidebar-max: 520px;
    }
    .layout {
      display: grid;
      grid-template-columns: var(--sidebar-width) 6px 1fr;
      gap: 0;
    }
    .sidebar {
      background: #f7f7f7;
      border: 1px solid #dfe2e5;
      border-radius: 8px;
      padding: 0.75rem;
      width: 100%;
      max-width: 100%;
      min-width: var(--sidebar-min);
      box-sizing: border-box;
      overflow-y: auto;
      position: sticky;
      top: 0.75rem;
      align-self: start;
      height: calc(100vh - 4rem);
    }
    .sidebar__header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-weight: 700;
      margin-bottom: 0.5rem;
    }
    .sidebar__reset {
      font-size: 0.85rem;
      text-decoration: none;
      color: #159957;
    }
    .sidebar__reset:hover,
    .sidebar__reset:focus-visible {
      text-decoration: underline;
    }
    .lecture-nav__list {
      list-style: none;
      padding: 0;
      margin: 0;
      display: flex;
      flex-direction: column;
      gap: 0.2rem;
    }
    .lecture-nav__heading {
      font-size: 0.85rem;
      font-weight: 700;
      text-transform: uppercase;
      color: #5c6f82;
      margin-top: 0.4rem;
    }
    .lecture-nav__list a {
      text-decoration: none;
      color: inherit;
      padding: 0.25rem 0.35rem;
      border-radius: 4px;
      display: block;
    }
    .lecture-nav__list a:hover,
    .lecture-nav__list a:focus-visible {
      background: #e6f3ec;
      color: #0c6d3f;
    }
    .lecture-nav__list a.active {
      background: #159957;
      color: #fff;
    }
    .sidebar-resizer {
      width: 6px;
      cursor: col-resize;
      background: transparent;
      position: relative;
    }
    .sidebar-resizer::after {
      content: "";
      position: absolute;
      top: 0;
      bottom: 0;
      left: 2px;
      width: 2px;
      background: #dfe2e5;
      border-radius: 2px;
    }
    .page-content {
      width: 100%;
    }
    @media (max-width: 819px) {
      .layout {
        grid-template-columns: 1fr;
      }
      .sidebar,
      .sidebar-resizer {
        display: none;
      }
    }
  </style>

  <script>
    (function() {
      var sidebar = document.getElementById('lectureSidebar');
      var resizer = document.getElementById('sidebarResizer');
      var resetBtn = document.getElementById('sidebarReset');
      if (!sidebar || !resizer) return;

      var stored = localStorage.getItem('sttSidebarWidth');
      if (stored) {
        sidebar.style.width = stored;
      }

      var startX = 0;
      var startWidth = 0;
      function onMouseMove(e) {
        var delta = e.clientX - startX;
        var minW = parseInt(getComputedStyle(document.documentElement).getPropertyValue('--sidebar-min'));
        var maxW = parseInt(getComputedStyle(document.documentElement).getPropertyValue('--sidebar-max'));
        var newWidth = Math.min(Math.max(startWidth + delta, minW), maxW);
        sidebar.style.width = newWidth + 'px';
      }
      function onMouseUp() {
        localStorage.setItem('sttSidebarWidth', sidebar.style.width);
        document.removeEventListener('mousemove', onMouseMove);
        document.removeEventListener('mouseup', onMouseUp);
      }
      resizer.addEventListener('mousedown', function(e) {
        startX = e.clientX;
        startWidth = sidebar.getBoundingClientRect().width;
        document.addEventListener('mousemove', onMouseMove);
        document.addEventListener('mouseup', onMouseUp);
      });
      if (resetBtn) {
        resetBtn.addEventListener('click', function(e) {
          e.preventDefault();
          sidebar.style.width = getComputedStyle(document.documentElement).getPropertyValue('--sidebar-width');
          localStorage.removeItem('sttSidebarWidth');
        });
      }
    })();
  </script>
</body>
</html>
